daemon off;

user root;
worker_processes 4;
pid /var/run/nginx.pid;

events {
  worker_connections 768;
}

error_log /dev/stdout info; # debug;

rtmp {
  server {
    access_log /dev/stdout;

    listen 1935;
    chunk_size 4096;

    application live {
      live on;

      on_publish http://rtmp-authenticator/;

      push <%= rtmpCDNHost %> app=<%= rtmpCDNApp %> passArgs=1;   # RTMP CDN
      push rtmp://vod-scribe/live passArgs=1;       # VOD scribe
      push rtmp://hls-chopper/live passArgs=1;      # HLS chopper
    }
  }
}
